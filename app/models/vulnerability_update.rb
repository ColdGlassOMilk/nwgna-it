class VulnerabilityUpdate < ApplicationRecord
  belongs_to :vulnerability_scan
  belongs_to :vulnerability

  enum update_type: { added: 0, removed: 1 }

  def self.ransackable_attributes(auth_object = nil)
    ["created_at", "id", "updated_at", "vulnerability_scan_id", "vulnerability_id"]
  end

  # Scope to filter by update_type
  scope :by_update_type, ->(type) { where(update_type: update_types[type]) }

  # Scope to filter by vulnerability_scan
  scope :by_scan, ->(scan_id) { where(vulnerability_scan_id: scan_id) }
end
